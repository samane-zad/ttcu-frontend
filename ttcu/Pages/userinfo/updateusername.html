
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/ttcu/src/css/main.css">
    <link rel="stylesheet" href="/ttcu/src/css/mainstyle.css">
   <link rel="stylesheet" href="/ttcu/public/darkmode/moon.css">
   <link rel="stylesheet" href="/ttcu/src/footer.css">
   <link rel="stylesheet" href="../../src/css/userinfo.css">
   <link rel="stylesheet"   href="../../src/css/modal.css">

   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
   <link rel=icon href="../../src/Logo/ttcu-icon.ico">
   <link rel="stylesheet" href="/ttcu/src/css/scroll.css">

   <title>اطلاعات کاربر</title>
  </head>
<body>
    <div class="scroll-button">  </div>

    <div class="grid-header">
        <div>
            <div class="header-dark">
                <div class="header" id="myHeader">  
                              <nav class="navbar navbar-dark navbar-expand-md navigation-clean-search">
                    <div class="container"><img src="/ttcu/public/Icon.png"><a class="navbar-brand" href="/ttcu/public/index.html">TTCU </a>
                        
                    
                        <button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1">
                            <span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                        <div class="collapse navbar-collapse" id="navcol-1">
    
    
                            <ul class="nav navbar-nav">
                                <li class="nav-item" role="presentation">  
                                    <div class="moon" onclick="myFunction()" class= dark-mode ></div></li>
    
                                
                                    <li class="nav-item" role="presentation"><a class="nav-link" href="/ttcu/Pages/user/html/index/index.html">خانه</a></li>
                                    <li class="nav-item" role="presentation"><a class="nav-link" href="/ttcu/Pages/about/about.html">درباره ما</a></li>
        
                                    <li class="nav-item" role="presentation"><a class="nav-link" href="/ttcu/Pages/blog/blogpage.html">بلاگ</a></li>
        
                                    <li class="nav-item" role="presentation"><a class="nav-link" href="/ttcu/Pages/contact-us/contact.html">تماس باما</a></li>
        
                             
    
    
                             
                            </ul>





                        <form class="form-inline mr-auto" target="_self">  </form>
                          
                        <span class="navbar-text">
                            <a href="../userinfo/userinfo.html" ><img src="../../src/img/per.PNG"></a>

                            <!-- <a class="btn btn-light action-button" role="button" href="../signup/Signup.html">ثبت نام</a> -->
                            <!-- <a a class="btn btn-light action-button" role="button" href="../login/login.html" class="login">ورود</a></span> -->
                 
            </nav>
        </div>
    </div>
</div>
</div>
<!----><div class="container emp-profile">
  <form method="post">
    <div class="row">
        <div class="col-md-4">
            <div class="profile-img">
                <img src="../../src/img/perso.PNG"alt=""/>
               <!-- <div class="file btn btn-lg btn-primary">
                    Change Photo
                    <input type="file" name="file"/>
                </div>-->
            </div>
        </div>
        <div class="col-md-6">
            <div class="profile-head" id="fullname">
                       
              
                        <br>
                        
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item">
                        <p class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">تغییر نام کاربری 
                        </p>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- <div class="col-md-2">
            <input type="submit" class="profile-edit-btn" name="btnAddMore" value="Edit Profile"/>
        </div> -->
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="profile-work">
               <br/><br/>
                <a onclick="updateUsername()">ثبت تغییرات </a><br/>

         
            </div>
        </div>
    
        <div class="col-md-8">
            <div class="tab-content profile-tab" id="myTabContent">
                
                            <div class="row">
                                <div class="col-md-6">
                                    <label>  نام کاربری فعلی </label>
                                </div>
                                <div class="col-md-6"  >
                                    <input id="oldUsername"  type="text1"  required   style="font-size: 25px;background-color:lavender"  autocomplete="off" /> 
                                </div>
                            </div>
                            <br/>
                            <div class="row">
                                <div class="col-md-6" >
                                    <label> نام کاربری جدید  </label>
                                </div>
                                <div class="col-md-6" >
                                    <input id="newUsername"  type="text1"  required   style="font-size: 25px;background-color:lavender"  autocomplete="off" /> 
                                </div>
                            </div>
                                       
            </div>
        </div>
    </div>
</form>  
<div class="join">
    <button id="modalbtn" class="btn btn-join" onclick="" style="visibility: hidden;">
    </button>
  </div>
  <div class="overlay">
    <div class="modal__locked">
      <div class="modal-body">
        <center>
          <strong id="title"> </strong>
          
          <h4 id="desc">
              
          </h4>
  
        </center>
      </div>
      <div class="modal-buttons">
        <button id="closebtn" class="btn btn-footer btn-purple" onclick="window.location.reload();">بستن</button>
        <button id="loginbtn" class="btn btn-footer btn-purple" onclick="window.location='../login/login.html'" style="visibility: hidden;">ورود</button>
      </div>
    </div>
  </div>         
</div>


    <!---->
    <footer class="footer">
        <div class="footer-left col-md-4 col-sm-6">
          <p class="about">
            <span> درباره ما</span> 
            تعامل در عصر تکنولوژی، یکی از دلایل اصلی پیدایش سیستم های نوین است. ما با ارائه این طرح، با هدف ایجاد بستری یکپارچه برای تعامل و اشتراک گذاری اطلاعات بین دانشجوها، اساتید و مدیران گروه دانشکده های فنی، سیستمی را که نظیر آن برای این قشر تنها به صورت محدود و پراکنده یافت می شد، ایجاد کرده ایم. طبق یافته ها و تجربیات به دست آمده از تحصیل در دانشکده فنی به عنوان یک دانشجو، تعاملات دانشجویان با یکدیگر و اساتید در مواردی نظیر اخبار دانشگاه، موارد درسی و آموزشی، اطلاعیه فراخوان ها و همچنین ارائه اطلاعات درمورد خدمات دانشجویی، خلاصه می شود. بستر TTCU برای پاسخگویی به احتیاجات دانشجویان در موارد مذکور طراحی توسعه داده شده است.

      
          </p>
          <div class="icons">
            <a href="#"><i class="fa fa-facebook"></i></a>
            <a href="#"><i class="fa fa-twitter"></i></a>
            <a href="#"><i class="fa fa-linkedin"></i></a>
            <a href="#"><i class="fa fa-google-plus"></i></a>
            <a href="#"><i class="fa fa-instagram"></i></a>
          </div>
        </div>
        <div class="footer-center col-md-4 col-sm-6">
          <div>
            <i class="fa fa-map-marker"></i>
            <p><span>اقدسیه- گلزار شرقی</span> تهران , ایران</p>
          </div>
          <div>
            <i class="fa fa-phone"></i>
            <a href="tel:+9822447053"> +98 22 44 70 53</a>





          </div>
          <div>
            <i class="fa fa-envelope"></i>
            <p>
              <a href="mailto:nezhadlotfi@protonmail.com">info@ttcu.com</a>            </p>
          </div>
        </div>
        <div class="footer-right col-md-4 col-sm-6">
          <h2> TTCU<span> <img src="../../public/Icon.png"></span></h2>
          <p class="menu">
            <a href="../../public/index.html"> خانه</a> |
            <a href="../about/about.html"> درباره ما</a> |
            <a href="../contact-us/contact.html"> تماس با ما</a>
          </p>
          <p class="name"> SamFa &copy; 2021</p>
        </div>
      </footer>



<script>

    function updateUsername(){
    var detailArr={};
    detailArr["oldUsername"]=document.getElementById("oldUsername").value;
    detailArr["newUsername"]=document.getElementById("newUsername").value;

    var xmlhttp;
    if(window.XMLHttpRequest){
     xmlhttp=new XMLHttpRequest;
    }
    else{
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=respond;
    function respond (){
    console.log(xmlhttp.readyState);
    console.log(xmlhttp.status);
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
      
      var response = JSON.parse(this.responseText);
        if(response.code == 200){
            console.log(response);
            localStorage.setItem("Token",null);
            document.getElementById("title").innerHTML="تغییر نام کاربری با موفقیت انجام شد"
            document.getElementById("desc").innerHTML="نام کاربری جدید :"+document.getElementById('newUsername').value;
            document.getElementById('loginbtn').style.visibility='visible';
            document.getElementById('closebtn').style.visibility='hidden';
            document.getElementById("modalbtn").click();
            
            
        
         
        }
        }
        else if(xmlhttp.status==403) {
            document.getElementById("title").innerHTML="تغییر نام کاربری انجام نشد"
            document.getElementById("desc").innerHTML="لطفا از صحت اطلاعات ورودی اطمینان حاصل فرمایید";
            document.getElementById("modalbtn").click();
    
        }
    else if(xmlhttp.status==400)
    {
        document.getElementById("title").innerHTML="تغییر نام کاربری انجام نشد"
            document.getElementById("desc").innerHTML="لطفا از صحت اطلاعات ورودی اطمینان حاصل فرمایید";
            document.getElementById("modalbtn").click(); 
    }
    else{
      console.log("Hello");
    
    }
    
    }
    
    
    xmlhttp.open('POST','http://127.0.0.1:8082/api/updateUsername',true);
    xmlhttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
    xmlhttp.setRequestHeader('Authorization',window.localStorage.getItem("Token"));
    
    xmlhttp.send(JSON.stringify(detailArr));
    }
    
    </script>


<script>
  loadUserInfo();
      function loadUserInfo(){
      var detailArr={};
      var xmlhttp;
      if(window.XMLHttpRequest){
       xmlhttp=new XMLHttpRequest;
      }
      else{
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange=respond;
      function respond (){
      console.log(xmlhttp.readyState);
      console.log(xmlhttp.status);
      if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
        
      }
      else if(xmlhttp.status==403||xmlhttp.status==404)
      {
          window.location.assign('/ttcu/Pages/login/login.html');
      }
      else{
        console.log("Hello");
      
      }
      
      }
      
      
      xmlhttp.open('GET','http://127.0.0.1:8082/api/getUserInfo',true);
      xmlhttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
      xmlhttp.setRequestHeader('Authorization',window.localStorage.getItem("Token"));
      
      xmlhttp.send(JSON.stringify(detailArr));
      }
      
      </script>
<script src="../../src/app/enumConverter.js"></script>
<script src="/ttcu/src/app/scroll.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="../../public/darkmode/darkmod.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
<script src="../../src/app/userinfo.js"></script>
<script src="../../src/app/modal.js"></script>
</body>
</html>
